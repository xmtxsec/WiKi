<span style='font-size:17px'>

# 1、网络安全漏洞概述

## 1.1、网络安全漏洞概念

网络安全漏洞又称为脆弱性，简称漏洞。漏洞一般是致使网络信息系统安全策略相冲突的缺陷，这种缺陷通常称为安全隐患。安全漏洞的影响主要有机密性受损、完整性破坏、可用性降低、抗抵赖性缺失、可控制性下降、真实性不保等。根据已经公开的漏洞信息，网络信息系统的硬件层、软硬协同层、系统层、网络层、数据层、应用层、业务层、人机交互层都已被发现存在安全漏洞。



根据漏洞的补丁状况，可将漏洞分为普通漏洞和零日漏洞(zero-day vulnerability)。普通漏洞是指相关漏洞信息已经广泛公开，安全厂商已经有了解决修补方案。而零日漏洞特指系统或软件中新发现的、尚未提供补丁的漏洞。零日漏洞通常被用来实施定向攻击(Targeted Attacks)。



## 1.2、网络安全漏洞威胁

网络信息系统漏洞的存在是网络攻击成功的必要条件之一，攻击者成功的关键在于早发现和利用目标的安全漏洞。



攻击者基于漏洞对网络系统安全构成的安全威胁主要有：敏感信息泄露、非授权访问、身份假冒、拒绝服务。

![image-20240425084715256](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202404250847561.png)



要实现网络系统安全，关键问题之一就是解决漏洞问题，包括漏洞检测、漏洞修补、漏洞预防等。



## 1.3、网络安全漏洞问题现状

由于软件及网络信息系统的复杂性，网络信息产品的安全漏洞问题还远未能解决。网络安全漏洞分析与管理技术正向智能化方向发展。国内外网络安全专家正在开展基于机器学习和大数据来分析网络信息系统安全漏洞的研究。



安全漏洞分析及漏洞管理是网络安全的基础性工作。



美国的 MITRE 公司开发通用漏洞披露 (Common Vulnerabilities and Exposures, CVE) 来统一规范漏洞命名。 MITRE 还建立了一个通用缺陷列表(Common Weakness Enumeration, CWE) ，用于规范化地描述软件架构、设计以及编码存在的安全漏洞 。



针对安全漏洞的危害性评估，事件响应与安全组织论坛(FIRST)制定和发布了通用漏洞评分系统(Common Vulnerability Scoring System, CVSS)。CVSS 采用十分制的方式对安全漏洞的严重性进行计分评估，分数越高则表明漏洞的危害性越大。CVSS 的最新版本是 v3.0 。



我国相关部门针对安全漏洞管理问题，建立起国家信息安全漏洞库 CNNVD 、国家信息安全漏洞共享平台 CNVD，制定和颁发了一系列漏洞标准规范，主要有《信息安全技术安全漏洞分类 CGB/T 33561一2017) 》、《信息安全技术安全漏洞等级划分指南
(GB/T 30279—2013)》、《信息安全技术安全漏洞标识与描述规范(GB/T 28458—2012) 》、《信息安全技术信息安全漏洞管理规范 (GB/T 30276—2013)》。



# 2、网络安全漏洞分类与管理

## 2.1、网络安全漏洞来源

网络信息系统的漏洞主要来自两个方面：

- 非技术性安全漏洞，涉及管理组织结构、管理制度、管理流程、人员管理等。
- 技术性安全漏洞，主要涉及网络结构、通信协议、设备、软件产品、系统配置、应用系统等。



**非技术性安全漏洞主要来源**

- 网络安全责任主体不明确：组织中缺少针对网络安全负责任的机构，或者是网络安全机构不健全，导致网络安全措施缺少责任部门落实。
- 网络安全策略不完备：组织中缺少或者没有形成一套规范的网络信息安全策略。
- 网络安全操作技能不足：组织中缺少对工作人员的网络安全职责规范要求，没有制度化的安全意识和技能培训机制。
- 网络安全监督缺失：组织中缺少强有力的网络信息安全监督机制，网络信息安全策略的实施无法落实，无法掌握网络安全态势。
- 网络安全特权控制不完备：网络信息系统中存在特权账号，缺少对超级用户权限的审计和约束，从而引发内部安全威胁。



**技术性安全漏洞主要来源**

- 设计错误(Design Error) ：由于系统或软件程序设计错误而导致的安全漏洞。
- 输入验证错误(Input Validation Error) ：由于未对用户输入数据的合法性进行验证，使攻击者非法进入系统。
- 缓冲区溢出(Buffer Overflow) ：输入程序缓冲区的数据超过其规定长度，造成缓冲区溢出，破坏程序正常的堆栈，使程序执行其他代码。
- 意外情况处置错误(Exceptional Condition Handling Error)：由于程序在实现逻辑中没有考虑到一些意外情况，而导致运行出错。
- 访问验证错误 (Access Validation Error)：由于程序的访问验证部分存在某些逻辑错误，使攻击者可以绕过访问控制进入系统。
- 配置错误(Configuration Error) ：由于系统和应用的配置有误，或配置参数、访问权限、策略安装位置有误。
- 竞争条件(Race Cond山on)：由于程序处理文件等实体在时序和同步方面存在问题，存在一个短暂的时机使攻击者能够施以外来的影响。
- 环境错误(Condition Error) ：由于一些环境变量的错误或恶意设置造成的安全漏洞。



## 2.2、网络安全漏洞分类

网络安全漏洞分类有利于漏洞信息的管理，但是目前还没有统一的漏洞分类标准。国际上较为认可的是 CVE 漏洞分类和 CVSS 漏洞分级标准。另外，还有我国信息安全漏洞分类及 OWSP 漏洞分类。

 

**CVE 漏洞分类**

CVE 给出已经公开的安全漏洞的统一标识和规范化描述，其目标是便于共享漏洞数据。CVE 条目的包含内容是标识数字、安全漏洞简要描述、至少有一个公开参考。标识数字简称 CVE ID，其格式由年份数字和其他数字组成。CVE 是国际上权威的网络安全漏洞发布组织，其成员包含众多全球知名的安全企业和研究机构。



**CVSS 漏洞分级标准**

CVSS 是一个通用漏洞计分系统分数计算依据由基本度量计分、时序度量计分、环境度量计分组成。以 CVSS v3.0 为例，其中，基本度量计分由攻击向量、攻击复杂性、特权要求、用户交互、完整性影响、保密性影响、可用性影响、影响范围等参数决定。时序度量计分由漏洞利用代码成熟度、修补级别、漏洞报告可信度等参数决定。环境度量计分由完整性要求、保密性要求、可用性要求、修订基本得分等决定。



**我国信息安全漏洞分类**

1. 国家信息安全漏洞库(CNNVD) 漏洞分类

   CNNVD 将信息安全漏洞划分为：配置错误、代码问题、资源管理错误、数字错误、信息泄露、竞争条件、输入验证、缓冲区错误、格式化字符串、跨站脚本、路径遍历、后置链接、SQL 注入、代码注入、命令注入、操作系统命令注入、安全特征问题、授权问题、信任管理、加密问题、未充分验证数据可靠性、跨站请求伪造、权限许可和访问控制、访问控制错误和资
   料不足。

   ![image-20240425091756064](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202404250917237.png)

   

2. 国家信息安全漏洞共享平台(CNVD) 漏洞分类

   CNVD 根据漏洞产生原因，将漏洞分为 11 种类型：输入验证错误、访问验证错误、意外情况处理错误数目、边界条件错误数目、配置错误、竞争条件、环境错误、设计错误、缓冲区错误、其他错误、未知错误。

   CNVD 依据行业划分安全漏洞，主要分为行业漏洞和应用漏洞。行业漏洞包括：电信、移动互联网、工控系统；应用漏洞包括 Web 应用、安全产品、应用程序、操作系统、数据库、网络设备等。

   在漏洞分级方面，将网络安全漏洞划分为高、中、低三种危害级别。



**OWASP 10 漏洞分类**

OWASP (Open Web Application Security Program) 组织发布了有关 Web 应用程序的前十种安全漏洞。目前，已发布多个版本，主要的漏洞类型有注入、未验证的重定向和转发、失效的身份认证、 XML 外部实体(XXE) 、敏感信息泄露、失效的访问控制、安全配置错误、跨站脚本 (XSS) 、不安全的反序列化、使用含有已知漏洞的组件、不足的日志记录和监控、非安全加密存储。



## 2.3、网络安全漏洞发布

安全漏洞发布 一般由软硬件开发商、安全组织、黑客或用户来进行。漏洞发布方式主要有三种形式：网站、电子邮件以及安全论坛。

网络管理员通过访问漏洞发布网站、安全论坛或订阅漏洞发布电子邮件就能及时获取漏洞信息。

漏洞信息公布内容一般包括：漏洞编号、发布日期、安全危害级别、漏洞名称、漏洞影响平台、漏洞解决建议等。



## 2.4、网络安全漏洞信息获取

目前，国内外漏洞信息来源主要有四个方面：

1. 网络安全应急响应机构。
2. 网络安全厂商。
3. IT 产品或系统提供商。
4. 网络安全组织。



国内外网络安全漏洞信息发布的主要来源，分别介绍如下：

1. CERT (Computer Emergency Response Team) 组织建立于 1988 年，是世界上第一个计算机安全应急响应组织，其主要的工作任务是提供入侵事件响应与处理。
2. Security Focus Vulnerability Database 是由 Security Focus 公司开发维护的漏洞信息库，它将许多原本零零散散的、与计算机安全相关的讨论结果加以结构化整理，组成了一个数据库。
3. CNNVD 是中国信息安全测评中心，为切实履行漏洞分析和风险评估职能，负责建设运维的国家级信息安全漏洞数据管理平台，旨在为国家信息安全保障提供服务。CNNVD 在信息安全漏洞搜集、重大漏洞信息通报、高危漏洞安全消控等方面发挥了重大作用，为国家重要行业和关键基础设施的安全保障工作提供了重要的技术支撑和数据支持。
4. 国家信息安全漏洞共享平台 (CNVD) 是由国家计算机网络应急技术处理协调中心联合国内重要的信息系统单位、基础电信运营商、网络安全厂商、软件厂商和互联网企业建立的信息安全漏洞信息共享知识库。 CNVD 已建立起软件安全漏洞统一收集验证、预警发布及应急处置体系，发布了《国家信息安全漏洞共享平台章程》。
5. 厂商漏洞信息，由厂商自己公布的其生产产品的安全漏洞信息。



## 2.5、网络安全漏洞管理过程

网络安全漏洞管理是把握网络信息系统安全态势的关键，是实施网络信息安全管理从被动向主动转变的标志性行动 。



网络安全漏洞管理主要包含以下环节 ：

1. **网络信息系统资产确认**：对网络信息系统中的资产进行摸底调查，建立信息资产档案。
2. **网络安全漏洞信息采集**：利用安全漏洞工具或人工方法收集整理信息系统的资产安全漏洞相关信息，包括安全漏洞
   类型、当前补丁级别、所影响到的资产。
3. **网络安全漏洞评估**：对网络安全漏洞进行安全评估，如安全漏洞对组织业务的影响、安全漏洞被利用的可能性、安全漏洞的修补级别，最后形成网络安全漏洞分析报告，给出网络安全漏洞威胁排序和解决方案。
4. **网络安全漏洞消除和控制**：常见的消除和控制网络安全漏洞的方法是安装补丁包、升级系统、更新 IPS 或 IDS 的特征
   库、变更管理流程。
5. **网络安全漏洞变化跟踪：**网络信息系统的漏洞数量、类型以及分布都在动态演变。安全管理员必须设法跟踪漏洞状态，持续修补信息系统中的漏洞。



# 3、网络安全漏洞扫描技术与应用

## 3.1、网络安全漏洞扫描

网络安全漏洞扫描是一种用于检测系统中漏洞的技术，是具有漏洞扫描功能的软件或设备，简称为漏洞扫描器。漏洞扫描器通过远程或本地检查系统是否存在已知漏洞。漏洞扫描器一般包括用户界面、扫描引擎、漏洞扫描结果分析、漏洞信息及配置参数库等主要功能模块，



按照扫描器运行的环境及用途，漏洞扫描器主要分为三种，即主机漏洞扫描器、网络漏洞扫描器、专用漏洞扫描器。



**主机漏洞扫描器**

主机漏洞扫描器不需要通过建立网络连接就可以进行 ， 其技术原理一般是通过检查本地系统中关键性文件的内容及安全属性，来发现漏洞，如配置不当、用户弱口令、有漏洞的软件版本等。主机漏洞扫描器的运行与目标系统在同一主机上，并且只能进行单机检测。



**网络漏洞扫描器**

网络漏洞扫描器的技术原理是通过与待扫描的目标机建立网络连接后，发送特定网络请求进行漏洞检查。网络漏洞扫描器与主机漏洞扫描的区别在于，网络漏洞扫描器需要与被扫描目标建立网络连接。网络漏洞扫描器便于远程检查联网的目标系统。但是，网络漏洞扫描器由于没有目标系统的本地访问权限，只能获得有限的目标信息，检查能力受限于各种网络服务中的漏洞检查，如 Web 、FTP 、Telnet 、SSH 、POP3 、SMTP 、SNMP 等。



**专用漏洞扫描器**

专用漏洞扫描器是主要针对特定系统的安全漏洞检查工具，如数据库漏洞扫描器、网络设备漏洞扫描器、Web 漏洞扫描器、工控漏洞扫描器。



## 3.2、网络安全漏洞扫描应用

网络安全漏洞扫描常用于网络信息系统安全检查和风险评估。通常利用漏洞扫描器检查发现服务器、网站、网络设备、数据库等的安全隐患，以防止攻击者利用。同时，根据漏洞扫描器的结果，对扫描对象及相关的业务开展网络安全风险评估。



Windows 服务器漏洞扫描的实例：

假设某网络管理员拟远程检查某台 Windows 服务器是否存在 RPC 漏洞，以防止网络蠕虫攻击。

该服务器的 IP 地址是 192.168.X.Y,则漏洞扫描解决方案如下：

1. 网络管理员从网络下载具有 RPC 漏洞扫描功能的软件 retinarpcdcom.exe;
2. 网络管理员把 retinarpcdcom.exe 安装到管理机上；
3. 网络管理员运行 retinarpcdcom.exe;
4. 网络管理员输入 Windows 服务器的 IP 地址；
5. 网络管理员查看扫描结果。



# 4、网络安全漏洞处置技术与应用

## 4.1、网络安全漏洞发现技术

网络安全漏洞的发现方法主要依赖于人工安全性分析、工具自动化检测及人工智能辅助分析。安全漏洞发现的通常方法是将已发现的安全漏洞进行总结，形成一个漏洞特征库，然后利用该漏洞库，通过人工安全分析或者程序智能化识别。漏洞发现技术主要有文本搜索、词法分析、范围检查、状态机检查、错误注入、模糊测试、动态污点分析、形式化验证等。



## 4.2、网络安全漏洞修补技术

补丁管理是一个系统的、周而复始的工作，主要由六个环节组成，分别是现状分析、补丁跟踪、补丁验证、补丁安装、应急处理和补丁检查。

![image-20240425100454210](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202404251004270.png)



## 4.3、网络安全漏洞利用防范技术

网络安全漏洞利用防范技术主要针对漏洞触发利用的条件进行干扰或拦截，以防止攻击者成功利用漏洞。

1. **地址空间随机化技术**：通过对程序加载到内存的地址进行随机化处理，使得攻击者不能事先确定程序的返回地址值，从而降低攻击成功的概率。
2. **数据执行阻止**：操作系统通过对特定的内存区域标注为非执行，使得代码不能够在指定的内存区域运行。
3. **SEHOP**：防止攻击者利用 Structured Exception Handler(SEH) 重写。
4. **堆栈保护**：通过设置堆栈完整性标记以检测函数调用返回地址是否被篡改，从而阻止攻击者利用缓冲区漏洞。
5. **虚拟补丁**：对尚未进行漏洞永久补丁修复的目标系统程序，在不修改可执行程序的前提下，检测进入目标系统的网络流量而过滤掉漏洞攻击数据包，从而保护目标系统程序免受攻击。虚拟补丁通过入侵阻断、 Web 防火墙等相关技术来实现给目标系统程序”打补丁“，使得黑客无法利用漏洞进行攻击。



# 5、网络安全漏洞防护主要产品与技术指标

## 5.1、网络安全漏洞扫描器

网络安全漏洞扫描器的产品技术原理是利用已公开的漏洞信息及特征，通过程序对目标系统进行自动化分析，以确认目标系统是否存在相应的安全漏洞。漏洞扫描器产品通常简称为＂漏扫＂。漏洞扫描器既是攻击者的有力工具，又是防守者的必备工具。利用漏洞扫描器可以自动检查信息系统的漏洞，以便及时消除安全隐患。



网络安全漏洞扫描产品常见的技术指标阐述如下：

1. 漏洞扫描主机数量。产品扫描主机的数量，有无 IP 或域名限制。
2. 漏洞扫描并发数。产品支持并发扫描任务的数量。
3. 漏洞扫描速度。产品在单位时间内完成扫描漏洞任务的效率。
4. 漏洞检测能力。产品检查漏洞的数量和类型，提供的漏洞知识库中是否覆盖主流操作系统、数据库、网络设备。
5. 数据库漏洞检查功能。对Oracle 、MySQL 、MS SQL 、DB2 、Sybase 、PostgreSQL 、Mongo DB 等数据库漏洞检查的支持程度。
6. Web 应用漏洞检查功能 。对 SQL 注入、跨站脚本、网站挂马、网页木马、CGI 漏洞等的检查能力。
7. 口令检查功能。产品支持的口令猜测方式类型，常见的口令猜测方式是利用SMB 、Telnet 、FTP 、SSH 、POP3 、Tomcat、SQL Server 、MySQL 、Oracle 、Sybase 、DB2 、SNMP 等进行口令猜测。是否支持外挂用户提供的用户名字典、密码字典和用户名密码组合字典。
8. 标准兼容性。产品漏洞信息是否兼容 CVE 、CNNVD 、CNVD 、BugTraq 等主流标准，并提供 CVE 兼容(CVE Compatible) 证书。
9. 部署环境难易程度。产品对部署环境要求的复杂程度，是否支待虚拟化 VM 平台部署。



## 5.2、网络安全漏洞服务平台

网络安全产业界推出漏洞相关的产品与服务，如漏洞盒子、补天漏洞响应平台、网络威胁情报服务等。

- 漏洞盒子隶属于上海斗象信息科技有限公司，是一个专业的互联网安全测试平台。
- 补天漏洞响应平台是专注于漏洞响应的第三方公益平台，通过 SRC、众测等方式引导民间的白帽力量，以安全众测的形式让白帽子成员模拟攻击者发现安全问题。
- 网络威胁情报服务常以安全漏洞通报的方式提供服务。相关服务机构主要是网络安全应急响应部门、网络安全厂商等，如国家互联网应急中心 CNCERT 、 CNCERT 网络安全应急服务支撑单位、CNVD （国家信息安全漏洞共享平台）技术组成员单位、国家网络与信息安全信息通报中心技术支持单位。



## 5.3、网络安全漏洞防护网关

网络安全漏洞防护网关的产品原理是通过从网络流量中提取和识别漏洞利用特征模式，阻止攻击者对目标系统的漏洞利用。常见产品的形式是 IPS (Intrusion Prevention System)、 Web防火墙（简称 WAF) 、统一威胁管理(UTM) 等。

相关产品常见的技术指标主要如下：

- 阻断安全漏洞攻击的种类与数量。产品能够防御安全漏洞被攻击利用的类型及数量。
- 阻断安全漏洞攻击的准确率。产品能够检测并有效阻止安全漏洞被攻击利用的正确程度。
- 阻断安全漏洞攻击的性能。在单位时间内，产品能够检测并有效阻止安全漏洞被攻击利用的数量。
- 支持网络带宽的能力。产品对网络流量大小的控制能力。

</span>