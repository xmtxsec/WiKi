
# 1、认证概念

## 1.1、认证概念
认证是一个实体向另外一个实体证明其所声称的身份的过程。在认证过程中，需要被证实的实体是声称者，负责检查确认声称者的实体是验证者。通常情况下，双方要按照一定规则， 声称者传递可区分其身份的证据给验证者，验证者根据所接收到的声称者的证据进行判断，证实声称者的身份。

认证一般由标识 (Identification) 和鉴别 (Authentication) 两部分组成。标识是用来代表实体对象（如人员、设备、数据、服务、应用）的身份标志，确保实体的唯一性和可辨识性，同时与实体存在强关联。标识一般用名称和标识符 (ID) 来表示。通过唯一标识符，可以代表实体。

鉴别一般是利用口令、电子签名、数字证书、令牌、生物特征、行为表现等相关数字化凭证对实体所声称的属性进行识别验证的过程。鉴别的凭据主要有所知道的秘密信息、所拥有的凭证、所具有的个体特征以及所表现的行为。 




## 1.2、认证依据
认证依据也称为鉴别信息，通常是指用于确认实体（声称者）身份的真实性或者其拥有的属性的凭证。

常见的认证依据主要有四类：

1. 所知道的秘密信息
2. 所拥有的实物凭证
3. 所具有的生物特征
4. 所表现的行为特征 




## 1.3、认证原理
认证机制由验证对象、认证协议、鉴别实体构成

- 验证对象是需要鉴别的实体（声称者）
- 认证协议是验证对象和鉴别实体（验证者）之间进行认证信息交换所遵从的规则
- 鉴别实体根据验证对象所提供的认证依据，给出身份的真实性或属性判断。



 按照对验证对象要求提供的认证凭据的类型数量，认证可以分成

- 单因素认证
- 双因素认证
- 多因素认证



根据认证依据所利用的时间长度，认证可分成

- 一次性口令
- 持续认证

一次性口令简称 OTP , 用与保护口令安全，防止口令重用攻击。

持续认证是指连续提供身份确认，对用户整个会话过程中的特征行为进行连续地监测，不间断地验证用户所具有的特性。其标志是将对事件的身份验证转变为对过程的身份验证。 持续认证所使用的鉴定因素主要是认知因素、物理因素、上下文因素 。




# 2、认证类型与认证过程
按照认证过程中鉴别双方参与角色及所依赖的外部条件，认证类型可分成单向认证、双向认证和第三方认证。 


## 2.1、单向认证
在认证过程中，验证者对声称者进行单方面的鉴别，而声称者不需要识别验证者的身份。声称者发送其标识和身份证明凭据给验证者 B, 然后检查声称者的发送消息，确认声称者的身份真实性。 



实现单向认证的技术方法有两种

![image-20240415102726528](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202404151034853.png)




## 2.2、双向认证
双向认证是指在认证过程中验证者对声称者进行单方面的鉴别，同时，声称者也对验证者的身份进行确认。参与认证的实体双方互为验证者。

![image.png](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202404151037609.png)

在网络服务认证过程中，双向认证要求服务方和客户方互相认证，客户方也认证服务方，这样就可以解决服务器的真假识别安全问题。




## 2.3、第三方认证
第三方认证是指两个实体在鉴别过程中通过可信的第三方来实现。可信的第三方简称 TTP (Trusted Third Party) 。

第三方与每个认证的实体共享秘密，实体A和实体B分别与它共享秘密密钥 KPA、KPB 。当实体A发起认证请求时，实体A向可信第三方申请获取实体A和实体B的密钥 KAB 然后实体A和实体B使用 KAB 加密保护双方的认证消息。

  ![image.png](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202404151041258.png)




# 3、认证技术方法

## 3.1、口令认证技术
口令认证是基于用户所知道的秘密而进行的认证技术，是网络常见的身份认证方法。

口令认证一般要求参与认证的双方按照事先约定的规则，用户发起服务请求，然后用户被要求向服务实体提供用户标识和用户口令，服务实体验证其正确性，若验证通过，则允许用户访问。

![image.png](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202404151052091.png)

目前，服务方实体通常会存储用户的口令信息。一般安全要求把口令进行加密变换后存储，口令非明文传输。



口令认证容易受到攻击，主要攻击方式有窃听、重放、中间人攻击、口令猜测等。

要实现口令认证的安全，应至少满足以下条件：

- 口令信息要安全加密存储
- 口令信息要安全传输
- 口令认证协议要抵抗攻击，符合安全协议设计要求
- 口令选择要求做到避免弱口令

为了保证口令认证安全，网络服务提供商要求用户遵循口令生成安全策略，同时对生成的口令进行安全强度评测。




## 3.2、智能卡技术
智能卡是一种带有存储器和微处理器的集成电路卡，能够安全存储认证信息，并具有一定的计算能力。通过智能卡来实现挑战/响应认证。

在挑战/响应认证中，用户会提供一张智能卡，智能卡会一直显示一个随时间而变化的数字。假如用户试图登录目标系统，则系统首先将对用户进行认证，步骤如下:

1. 用户将自己的 ID 发送到目标系统；
2. 系统提示用户输入数字；
3. 用户从智能卡上读取数字；
4. 用户将数字发送给系统；
5. 系统用收到的数字对 ID 进行确认，如果 ID 有效，系统会生成一个数字并将其显示给用户，称为挑战；
6. 用户将上面的挑战输入智能卡中；
7. 智能卡用这个输入的值根据一定算法计算出一个新的数字并显示这个结果，该数字称为应答；
8. 用户将应答输入系统；
9. 系统验证应答是否正确，如果正确，用户通过验证并登录进入系统。  

![image.png](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202404151056217.png)




## 3.3、基于生物特性认证技术
基于生物特征认证就是利用人类生物特征来进行验证。目前，指纹、人脸、视网膜、语音等生物特征信息可用来进行身份认证。 人的指纹与生俱来，而且一生不变。视网膜认证是根据人眼视网膜中的血管分布模式不同来鉴别不同人的身份。语音认证则是依靠人的声音的频率来判断不同人的身份。

1. 指纹识别系统由指纹采集、指纹处理、指纹登记、指纹比对等技术模块组成。
2. 人脸识别认证系统涉及人脸采集、人脸处理、人脸存储、人脸识别。 人脸识别认证系统一般由客户端、服务器端、安全传输通道组成。
   - 客户端由环境检测、人脸采集、活体检测、质量检测、安全管理等模块组成，模块应在可信环境中执行。
   - 服务器端由活体判断、质量判断、人脸注册、入脸数据库、人脸识别、比对策略、安全管理等模块组成。 
3. 虹膜识别系统一般包含图像采集、图像处理分析、 虹膜登记处理、用户识别处理、数据存储、传输管理、回答信息处理等功能模块。系统实现两种基本功能：虹膜登记和用户识别。




## 3.4、Kerberos 认证技术
Kerberos 是一个网络认证协议，其目标是使用密钥加密为客户端/服务器应用程序提供强身份认证。其技术原理是利用对称密码技术，使用可信的第三方来为应用服务器提供认证服务， 并在用户和服务器之间建立安全信道。

一个 Kerberos 系统涉及四个基本实体：

1. Kerberos 客户机，用户用来访问服务器设备；
2. AS (Authentication Server, 认证服务器） ，识别用户身份并提供 TGS 会话密钥；
3. TGS (Ticket Granting Server, 票据发放服务器），为申请服务的用户授予票据 (Ticket); 
4. 应用服务器 (Application Server) ，为用户提供服务的设备或系统。

其中，通常将 AS、TGS 统称为 KDC (Key Distribution Center) 。票据 (Ticket) 是用于安全的传递用户身份所需要的信息的集合，主要包括客户方 Principal 、目的服务方 Principal 客户方 IP 地址、时间戳（分发该 Ticket 的时间）、 Ticket 的生存期、以及会话密钥等内容。

![image.png](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202404151134696.png)

1. Kerberos 客户向认证服务器 AS 申请票据 TGT；
2.  认证服务器 AS 收到 Kerberos 客户发来的消息后， AS 在认证数据库检查确认 Kerberos 客户，产生一个会话密钥，同时使用 Kerberos 客户的秘密密钥对会话密钥加密，然后生成一个票据 TGT, 其中 TGT 由 Kerberos 客户的实体名、地址、时间戳、限 制时间、会话密钥组成。 AS 生成 TGT 完毕后，把 TGT 发送给 Kerberos 客户。
3. Kerberos 客户收到 AS 发来的 TGT 后，使用自己的秘密密钥解密得到会话密钥，然后利用解密的信息重新构造认证请求单，向 TGS 发送请求，申请访问应用服务器 AP 所需要的票据。
4. TGS 使用其秘密密钥对 TGT 进行解密，同时，使用 TGT 中的会话密钥对 Kerberos 客户的请求认证单信息进行解密，并将解密后的认证单信息与 TGT 中信息进行比较。然后， TGS 生成新的会话密钥以供 Kerberos 客户和应用服务器使用，并利用各自的秘密密钥加密会话密钥。最后，生成一个票据，其由 Kerberos 客户的实体名、地址、时间、限制时间、会话密钥组成。 TGS 生成 TGT 完毕后，把 TGT 发送给 Kerberos 客户。
5. Kerberos 客户收到 TGS 的响应后，获得与应用服务器共享的会话密钥。与此同时， Kerberos 客户生成一个新的用于访问应用服务器的认证单，并用与应用服务器共享的会话密钥加密，然后与 TGS 发送来的票据一并传送到应用服务器。
6. 应用服务器确认请求。



经过 AS、TGS 两重认证的优点主要有两点

1. 可以显著减少用户密钥的密文的暴露次数.
2. 认证过程具有单点登录的优点，只要用户拿到了 TGT 并且该 TGT 没有过期，那么用户就可以使用该 TGT 通过 TGS 完成到任一服务器的认证过程而认证技术原理与应用不必重新输入密码。



缺点：

1. Kerberos 认证系统要求解决主机节点时间同步问题和抵御拒绝服务攻击。如果某台主机的时间被更改，那么这台主机就无法使用 Kerberos 认证协议了， 如果服务器的时间发生了错误，那么整个Kerberos 认证系统将会瘫痪。




## 3.5、公钥基础设施(PKI)技术
KPI 不仅能够实现加密服务，而且也能提供识别和认证服务。

针对公钥的真实性和所有权问题，人们采用“公钥证书”的方法来解决，类似身份证、护照。

公钥证书是将实体和一个公钥绑定， 并让其他的实体能够验证这种绑定关系。为此，需要一个可信第三方来担保实体的身份，这一个第三方称为认证机构，简称 CA (Certification Authority) CA 负责颁发证书，证书中含有实体名、公钥以及实体的其他身份信息。而 PKI (Public Key Infrastructure) 就是有关创建、 管理、存储、分发和撤销公钥证书所需要的硬件、软件、人员、策略和过程的安全服务设施。 

PKI 提供了一种系统化的、可扩展的、统一的、容易控制的公钥分发方法。基于 PKI 的主要安全服务有身份认证、完整性保护、数字签名、会话加密管理、密钥恢复。一般来说， PKI 涉及多个实体之间的协商和操作，主要实体包括 CA、RA 、终端实体 CEnd Entity) 、客户端、 目录服务器。

- **CA：**证书授权机构，主要进行证书的颁发、废止和更新。
- **RA ：**证书登记权威机构，将公钥和对应的证书持有者的身份及其他属性联系起来，进行注册和担保。
- **目录服务器： **CA 通常使用一个目录服务器，提供证书管理和分发的服务。
- **终端实体 ：**指需要认证的对象。 
- **客户端：**指需要基于 PKI 安全服务的使用者。  




## 3.6、单点登录
单点登录 (Single Sign On) 是指用户访问使用不同的系统时，只需要进行一次身份认证， 就可以根据这次登录的认证身份访问授权资源。单点登录解决了用户访问使用不同系统时，需要输入不同系统的口令以及保管口令问题，简化了认证管理工作。




## 3.7、基于人机识别认证技术
基于人机识别认证技术通常称为 CAPTCHA 技术。 CAPTCHA 技术主要包括文本 CAPTCHA 、图像 CAPTCHA 、语音 CAPTCHA。

CAPTCHA 技术的工作机制是认证者事先有一个 CAPTCHA 服务器负责 CAPTCHA 信息的生成和测试，当用户使用需要 CAPTCHA 验证的服务时候， CAPTCHA 服务器则给用户生成 CAPTCHA 测试，如果用户测试结果正确，则认证通过。




## 3.8、多因素认证技术
多因素认证技术使用多种鉴别信息进行组合，以提升认证的安全强度。根据认证机制所依赖的鉴别信息的多少，认证通常称为双因素认证或多因素认证。




## 3.9、基于行为的身份鉴别技术
基于行为的身份鉴别是根据用户行为和风险大小而进行的身份鉴别技术。  




## 3.10、快速在线认证
快速在线认证 (FIDO), FIDO 使用标准公钥加密技术来提供强身份验证。设计目标是保护用户隐私，不提供跟踪用户的信息，用户生物识别信息不离开用户的设备。 

FIDO 的技术原理描述如下：

1. 登记注册，用户创建新的公私钥密钥对。其中，私钥保留在用户端设备中，只将公钥注册到在线服务。公钥将发送到在线服务并与用户账户关联。私钥和有关本地身份验证方法的任何信息永远不会离开本地设备。
2. 登录使用，当用户使用 FIDO 进行登录在线服务的时候，在线服务提示要求用户使用以前注册的设备登录。然后，用户使用与注册时相同的方法解锁 FIDO 身份验证器。用户根据 账户标识符选择正确的密钥响应在线服务的挑战，并发送签名的质询到在线服务。最后，在线服务使用存放的用户公钥和日志来验证用户响应是否正确。若正确，则通过用户认证，允许登录在线服务。



FIDO 协议给了用户客户端身份验证方法的通用接口，浏览器可以使用标准 API 调用 FIDO 进行身份验证。 FIDO 支持客户端不同的身份验证方法，如安全 PIN 、生物识别（人脸、 语音、虹膜、指纹识别）以及符合 FIDO 标准要求的认证设备等。




# 4、认证主要产品与技术标准
认证技术产品是最为普遍的网络安全产品，其产品形态有硬件实体模式、软件模式或软硬结合模式。商业产品主要为物理硬件实体，安全功能软件集成到硬件实体中。




## 4.1、认证主要产品
目前，认证技术主要产品类型有五类：

1. 系统安全增强，系统安全增强产品的技术特点是利用多因素认证技术增强操作系统、数据库系统、网站等的认证安全强度。
2. 生物认证，生物认证产品的技术特点是利用指纹、人脸、语音等生物信息对人的身份进行鉴别。
3. 电子认证服务，电子认证服务产品的技术特点是电子认证服务机构采用 PKI 技术、密码算法等提供数字证书申请、颁发、存档、查询、废止等服务，以及基千数字证书为电子活动提供可信身份、可信时间和可信行为综合服务。
4. 网络准入控制，网络准入控制产品的技术特点是采用基于 802.1X 协议、 Radius 协议、 VPN 等的身份验证相关技术，与网络交换机、路由器、安全网关等设备联动，对入网设备进行身份认证和安全合规性验证，防范非安全设备接入内部网络。
5. 身份认证网关，身份认证网关产品的技术特点是利用数字证书、数据同步、网络服务重定向等技术，提供集中、统一的认证服务，形成身份认证中心，具有单点登录、安全审计等安全服务功能。




## 4.2、主要技术指标
认证技术产品的评价指标：

- 安全功能要求
- 性能要求
- 安全保障要求



认证技术产品的主要技术指标：

- 密码算法支持：认证技术主要依赖于密码技术，因此，认证产品中的密码算法是安全性的重要因素。
- 认证准确性：认证产品的认假率、拒真率。
- 用户支持数量：认证产品最大承载的用户数量。
- 安全保障级别：认证产品的安全保障措施、安全可靠程度、抵抗攻击能力等。




#  5、认证技术应用
认证技术是网络安全保障的基础性技术应用场景如下：

1. 用户身份验证：验证网络资源的访问者的身份，给网络系统访问授权提供支持服务。
2. 信息来源证实：验证网络信息的发送者和接收者的真实性，防止假冒。
3. 信息安全保护：通过认证技术保护网络信息的机密性、完整性，防止泄密、篡改、重 放或延迟。




## 5.1、校园信任体系系建设应用参考
在校园内部建设数字证书发放和服务体系，进行数字身份凭证的管理。 通过严格按照相关规范进行身份验证，实现对物理身份与数字身份的对应，并通过对数字证书的申请、发放、吊销、更新等管理过程，实现数字身份凭证的管理。建立的统一认证管理系统， 围绕整合的用户、应用系统等资源的管理，构建网络信任体系的基础设施平台。平台实现基于数字证书的身份认证，实现基于角色或资源的授权管理，实现统一的安全策略设定和维护，实现责任认定的安全审计。建立 PKI 应用支持系统，为校园内部其他应用系统提供可信的数据电文服务。

![image-20240415114755845](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202404151147941.png)




## 5.2、网络路由认证应用参考
路由安全是网络安全的基础，为了保证路由安全，路由器设备的访问及路由消息都需要进行认证。

1. 用户认证，当一个用户访问路由器时，必须经过认证通过后才能被允许。 
2. 路由器邻居认证，路由器邻居认证的类型有 OSPF 认证、 RIP EIGRP 认证。认证模式有明文认证 、消息摘要认证。明文认证不安全，口令容易被监听。为保护路由安全，一般推荐采用消息摘要认证。




## 5.3、基于人脸识别机房门禁管理应用参考
基于人脸识别机房门禁管理系统利用先进的生物识别技术，通过人脸特征信息快速判断人员身份，客观控制门禁系统，彻底杜绝通过伪造证件冒名顶替、利用他人证件通过及擅自进入的可能性。人员进出数据及现场记录图像可实时上传管理端，帮助管理者轻松、高效地进行安全管理工作。  




## 5.4、elD 身份验证应用参考
公民网络电子身份标识（简称 eID) 是国家网络安全的重要保障。 eID 是由国家主管部门颁发，与个人真实身份具有一一对应关系，用于在线识别公民真实身份的网络电子身份。由一对非对称密钥和含有其公钥及相关信息的数字证书组成。 



 eID 身份验证涉及 eID 服务平台、应用服务提供商和持有 eID 的用户。

 eID 身份验证服务相关步骤：

1. 应用服务提供商根据需要向 eID 服务平台发送服务请求。
2. eID 服务平台返回一个随机数作为本次验证服务的挑战。
3. 应用服务提供商完成相应的 eID 运算，将待传输数据按照所规定的格式作为验证请求， 发送给 eID 服务平台。
4. eID 服务平台在本地执行相关的验证服务后，按照规定格式返回相应的验证结果给应 用服务提供商。

![image-20240415115044515](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202404151150583.png)




## 5.5、HTTP 认证应用参考
HTTP Web 服务器应用协议，支持的认证方式主要有基本访问认证、数字摘要认证、NTLM、Negotiate、Windows Live ID 等。

HTTP 认证过程框架
![image.png](https://cdn.jsdelivr.net/gh/xmtxsec/picture/imgl/202404151151741.png)