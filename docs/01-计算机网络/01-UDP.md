
# 用户数据报协议UDP
UDP协议只在IP的数据报服务之上增加了很少一点的功能，就是**复用**和**分用**的功能以及**差错检测**的功能。


## UDP的主要特点

1.  UDP是无连接的，即发送数据之前不需要建立连接(当然，发送数据结束时也没有连接可释放)，因此减少了开销和发送数据之前的时延。 
2.  UDP使用尽最大努力交付，即不保证可靠交付，因此主机不需要维持复杂的连接状态表。 
3.  UDP是面向报文的。发送方的UDP对应用程序交下来的报文，在添加首部后就向下交付IP层。UDP对应用层交下来的报文，既不合并，也不拆分，而是保留这些报文的边界。这就是说，应用层交给UDP多长的报文，UDP就照样发送，即一次发送一个报文，在接收方的UDP,对IP层交上来的UDP用户数据报，在去除首部后就原封不动地交付上层的应用进程。 
4.  UDP没有拥塞控制，因此网络出现的拥塞不会使源主机的发送速率降低。 
5.  UDP支持一对一、一对多、多对一和多对多的交互通信。 
6.  UDP的首部开销小，只有8个字节，比TCP的20个字节的首部要短。 


## UDP的首部格式
用户数据报UDP有两个字段:**数据字段**和**首部字段**。首部字段很简单，只有8个字节，由四个字段组成，每个字段的长度都是两个字节。各字段意义如下:

1. 源端口,源端口号。在需要对方回信时选用。不需要时可用全0。
2. 目的端口，目的端口号。这在终点交付报文时必须使用。
3. 长度，UDP用户数据报的长度，其最小值是8 (仅有首部)。
4. 检验和，检测UDP用户数据报在传输中是否有错。有错就丢弃。<br />![](https://img-blog.csdnimg.cn/c922c3582ce64bdf945d9cd7e602edc8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5bCP6bij5ZCM5a2m4oSh,size_17,color_FFFFFF,t_70,g_se,x_16#crop=0&crop=0&crop=1&crop=1&id=rJRKB&originHeight=271&originWidth=542&originalType=binary&ratio=1&rotation=0&showTitle=false&status=done&style=none&title=)

当运输层从IP层收到UDP数据报时，就根据首部中的目的端口，把UDP数据报通过相应的端口，上交最后的终点一应用进程。如果接收方UDP发现收到的报文中的目的端口号不正确(即不存在对应于该端口号的应用进程)，就丢弃该报文，并由网际控制报文协议ICMP发送“端口不可达”差错报文给发送方。
